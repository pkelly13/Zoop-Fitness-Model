i=6
samplei=faData[i,]
cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]
cni
cn.noNA
if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	else{#
		mgC_L=NA#
	}
if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}
mgC_L
resourceQual<-c()#
for(i in 1:6){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA>=1)){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
i=1
samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]
samplei
cni
if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA>=1)){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)
resourceQual
i=6
samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA>=1)){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)
resourceQual<-c()#
for(i in 1:6){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA)>=){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
resourceQual<-c()#
for(i in 1:6){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA)>=1){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
resourceQual
resourceQual<-c()#
for(i in 1:nrow(faData)){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA)>=1){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
resourceQual<-c()#
for(i in 1:10){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA)>=1){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
resourceQual<-c()#
for(i in 1:9){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA)>=1){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
resourceQual<-c()#
for(i in 1:8){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA)>=1){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
resourceQual<-c()#
for(i in 1:7){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA)>=1){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
resourceQual<-c()#
for(i in 1:6){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA)>=1){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
i=7
samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]
samplei
cni
cn<-cn[as.numeric(cn$volFiltered)<1000,]
cn
cn<-cn[!is.na(cn$mgC_L),]
cn
cn[cn$lakeID=='RB',]
resourceQual<-c()#
for(i in 1:7){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA)>=1){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
resourceQual<-c()#
for(i in 1:10){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA)>=1){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
resourceQual<-c()#
for(i in 1:nrow(faData)){#
	samplei=faData[i,]#
	cni=cn[cn$lakeID==samplei$lakeID & cn$depthClass==samplei$depthClass,]#
	cn.noNA=cni[!is.na(cni$Pmg_Cmg),]#
	if(nrow(cni)>=1){#
	mgC_L=cni$mgC_L[which(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cni$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cni)<1){#
		mgC_L=NA#
	}#
	if(nrow(cn.noNA)>=1){#
	mgP_mgC=cn.noNA$Pmg_Cmg[which(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(cn.noNA$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	}#
	if(nrow(cn.noNA)<1){#
		mgP_mgC=NA		#
	}#
	samplei$mgC_L=mgC_L#
	samplei$mgP_mgC=mgP_mgC#
	resourceQual=rbind(samplei,resourceQual)#
}
resourceQual
tapply(resourceQual$mgP_mgC[resourceQual$depthClass=='PML'],resourceQual$lakeID[resourceQual$depthClass=='PML'],mean,na.rm=T)
tapply(resourceQual$mgP_mgC[resourceQual$depthClass=='Hypo'],resourceQual$lakeID[resourceQual$depthClass=='Hypo'],mean,na.rm=T)
head(resourceQual)
resourceQual$mgEPA_mgC<-(resourceQual$EPA_ugL/1000)/resourceQual$mgC_L#
resourceQual$mgDHA_mgC<-(resourceQual$DHA_ugL/1000)/resourceQual$mgC_L#
resourceQual$C18PUFA_mgC<-(resourceQual$C18PUFA_ugL/1000)/resourceQual$mgC_L
head(resourceual)
head(resourceQual)
ncol(resourceQual)
resourceQual<-resourceQual[,c(4,6,8,22:26)]
resourceQual
setwd('~/Documents/Notre Dame/UNDERC 2013/zoop growth model/R files')#
write.csv(resourceQual,'resourceQuality_growth model.csv')
head(chaobDens)
i=1
samplei=chaobDens[i,]
samplei
RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]
RQi
epa=resourceQual$mgEPA_mgC[which(abs(as.Date(resourceQual$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(resourceQual$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]
epa
which(abs(as.Date(resourceQual$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(resourceQual$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))
epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]
epa
dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]
dha
PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]
PC
C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]
modelParms<-c()#
for(i in nrow(chaobDens)){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms
chaobDens
modelParms<-c()#
for(i in 1:nrow(chaobDens)){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:10){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:9){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:8){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:5){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:4){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:3){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
i=4
samplei=chaobDens[i,]
samplei
RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]
RQi
?aggregate
x=aggregate(resourceQual$mgC_L,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)
x
head(resourceQual)
colnames(x)=c('lakeID','dateSample','depthClass','mgC_L')
y=aggregate(resourceQual$mgP_mgC,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)
head(y)
head(x)
colnames(y)=c('lakeID','dateSample','depthClass','mgP_mgC')
z=aggregate(resourceQual$mgEPA_mgC,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)
colnames(z)=c('lakeID','dateSample','depthClass','mgEPA_mgC')
a=aggregate(resourceQual$mgDHA_mgC,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)
colnames(a)=c('lakeID','dateSample','depthClass','mgDHA_mgC')
b=aggregate(resourceQual$C18PUFA_mgC,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)
colnames(b)=c('lakeID','dateSample','depthClass','C18PUFA_mgC')
data.frame(x[,1],y[,1],z[,1],a[,1],b[,1])
x[,1]==y[,1]==z[,1]==a[,1]==b[,1]
x[,1]==y[,1]
z[,1]==a[,1]
b[,1]==a[,1]
resourceQual=cbind(x,y[,4],z[,4],a[,4],b[,4])
resourceQula
resourceQual
resourceQual=cbind(x,mgP_mgC=y[,4],mgEPA_mgC=z[,4],mgDHA_mgC=a[,4],C18PUFA_mgC=b[,4])
resourceQual
modelParms<-c()#
for(i in 1:3){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms
modelParms<-c()#
for(i in 1:nrow(chaobDens)){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:10){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:20){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:30){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
nrow(chaobDens)
modelParms<-c()#
for(i in 1:100){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:70){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:60){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:50){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:40){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:20){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:25){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:30){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:35){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:38){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms<-c()#
for(i in 1:39){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
i=39
samplei=chaobDens[i,]
samplei
chaobDens<-chaobDens[chaobDens$lakeID!='CR',]
match chaoborus data with resource qual data from the closest date similar to how resource quality data was matched#
modelParms<-c()#
for(i in 1:39){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms
modelParms<-c()#
for(i in 1:nrow(chaobDens)){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms
unique(modelParms$lakeID)
head(resourceQual)
vary PHYT values from 0 to 100#
FQphyt=0.7#
PHYT=seq(0,1,by=0.05)#
#
times=seq(1,50,by=0.1)#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
PHYTgrowth<-c()#
for(i in 1:length(PHYT)){#
	parms<-c(FQphyt=FQphyt,PHYT=PHYT[i],FQdet=FQdet,DETc=DETc,aC1=aC1,aC2=aC2,lambda=lambda,wPhyt=wPhyt,wDet=wDet,mu=mu,PCphyt=PCphyt,fEPA=fEPA,fDHA=fDHA,sPC=sPC,sEPA=sEPA,sDHA=sDHA,tP=tP,tEPA=tEPA,tDHA=tDHA,tM=tM,m=m,v=v,e=e,Pmin=Pmin,Popt=Popt,EPAmin=EPAmin,EPAopt=EPAopt,DHAmin=DHAmin,DHAopt=DHAopt,X=X,hEPA=hEPA,hDHA=hDHA,r=r)#
	x=ode(y=n,times=times,func=timestep,parms=parms)#
	glimP=(x[49,2]-Pmin)/(Popt-Pmin)#
	glimEPA=(x[49,3]-EPAmin)/(EPAopt-EPAmin)#
	glimDHA=(x[49,4]-DHAmin)/(DHAopt-DHAmin)#
	PHYTgrowth[i]=r*min(glimP,glimEPA,glimDHA)#
}
FQphyt=0.7 #food quality index for phytoplankton - dimless #
PHYT=0.4 #food concentration of phytoplankton - mg C? <-----user input#
FQdet=0.1 #food quality of detritus - dimless#
DETc=0.1 #concentration of detritus - mg C?#
aC1=0.9 #zooplankton carbon assimilation efficiency - dimless#
aC2=0.03 #half sat constant for zoop growth efficiency - (mg C L-1)^1/2#
lambda=0.6 #maximum zooplankton grazing rate -  day^-1#
wPhyt=0.5 #phytoplankton food preference - dimless#
wDet=0.5 #detritus food preference - dimless#
mu=0.035 #zooplankton grazing half sat constant#
PCphyt=0.015 #phytoplankton P:C - mg P mg C^-1 <----User input#
fEPA=0.01 #phytoplankton EFA:C - mg EPA mg C^-1 <----User input#
fDHA=0.0003 #phytoplankton DHA:C - mg DHA mg C^-1#
sPC=0.00001 #detritus P:C - mg P mg C^-1#
sEPA=0.00001 #detritus EPA:C - mg EPA mg C^-1#
sDHA=0.00001 #detritus DHA:C - mg DHA mg C^-1#
tP=0.1 #zooplankton P biomass turnover rate - day ^-1#
tEPA=0.1 #zooplankton biomass EPA turnover rate - day^-1#
tDHA=0.1 #zooplankton biomass DHA turnover rate - day ^-1#
tM=0.05 #zooplankton moult P turnover rate - day^-1#
m=0.05 #moult as a fraction of zoop biomass - dimless#
v=0.5 #conversion efficiency of EPA to DHA - mg DHA mg EPA^-1#
e=0.05 #fraction of EPA to DHA via conversion - dimless#
Pmin=0.009 #minimum zooplankton somatic P - mg P mg C^-1#
Popt=0.05 #optimal zooplankton somatic P - mg P mg C^-1#
EPAmin=0.0007 #minimum zooplankton somatic EPA - mg EPA mg C-1#
EPAopt=0.0082 #Optimum zooplankton somatic EPA - mg EPA mg C-1#
DHAmin=0.0001 #minimum zooplankton somatic DHA - mg DHA mg C-1#
DHAopt=0.0014 #Optimum zooplankton somatic DHA - mg DHA mg C^-1#
X=0.25 #Excretion rate - day^-1#
hEPA=0.8 #proxy reproduction paramter#
hDHA=0.8 #proxy reproduction parameter#
r=0.9 # growth rate#
p=0.5 #elongation efficiency#
thresh=0.05 #threshold for post maintenance concentration of EPA and DHA#
Jpufa=0.0118 #flux of C18 pufa to EPA
PHYT=seq(0,1,by=0.05)
times=seq(1,50,by=0.1)
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)
PHYTgrowth<-c()
for(i in 1:length(PHYT)){#
	parms<-c(FQphyt=FQphyt,PHYT=PHYT[i],FQdet=FQdet,DETc=DETc,aC1=aC1,aC2=aC2,lambda=lambda,wPhyt=wPhyt,wDet=wDet,mu=mu,PCphyt=PCphyt,fEPA=fEPA,fDHA=fDHA,sPC=sPC,sEPA=sEPA,sDHA=sDHA,tP=tP,tEPA=tEPA,tDHA=tDHA,tM=tM,m=m,v=v,e=e,Pmin=Pmin,Popt=Popt,EPAmin=EPAmin,EPAopt=EPAopt,DHAmin=DHAmin,DHAopt=DHAopt,X=X,hEPA=hEPA,hDHA=hDHA,r=r)#
	x=ode(y=n,times=times,func=timestep,parms=parms)#
	glimP=(x[49,2]-Pmin)/(Popt-Pmin)#
	glimEPA=(x[49,3]-EPAmin)/(EPAopt-EPAmin)#
	glimDHA=(x[49,4]-DHAmin)/(DHAopt-DHAmin)#
	PHYTgrowth[i]=r*min(glimP,glimEPA,glimDHA)#
}
plot(PHYT,PHYTgrowth)
Calculate growth rate#
#List of parameters - only need to change a few for differences in resource quality#
FQphyt=0.7 #food quality index for phytoplankton - dimless #
PHYT=0.4 #food concentration of phytoplankton - mg C? <-----user input#
FQdet=0.1 #food quality of detritus - dimless#
DETc=0.1 #concentration of detritus - mg C?#
aC1=0.9 #zooplankton carbon assimilation efficiency - dimless#
aC2=0.03 #half sat constant for zoop growth efficiency - (mg C L-1)^1/2#
lambda=0.6 #maximum zooplankton grazing rate -  day^-1#
wPhyt=1 #phytoplankton food preference - dimless#
wDet=0 #detritus food preference - dimless#
mu=0.035 #zooplankton grazing half sat constant#
PCphyt=0.015 #phytoplankton P:C - mg P mg C^-1 <----User input#
fEPA=0.01 #phytoplankton EFA:C - mg EPA mg C^-1 <----User input#
fDHA=0.0003 #phytoplankton DHA:C - mg DHA mg C^-1#
sPC=0.00001 #detritus P:C - mg P mg C^-1#
sEPA=0.00001 #detritus EPA:C - mg EPA mg C^-1#
sDHA=0.00001 #detritus DHA:C - mg DHA mg C^-1#
tP=0.1 #zooplankton P biomass turnover rate - day ^-1#
tEPA=0.1 #zooplankton biomass EPA turnover rate - day^-1#
tDHA=0.1 #zooplankton biomass DHA turnover rate - day ^-1#
tM=0.05 #zooplankton moult P turnover rate - day^-1#
m=0.05 #moult as a fraction of zoop biomass - dimless#
v=0.5 #conversion efficiency of EPA to DHA - mg DHA mg EPA^-1#
e=0.05 #fraction of EPA to DHA via conversion - dimless#
Pmin=0.009 #minimum zooplankton somatic P - mg P mg C^-1#
Popt=0.05 #optimal zooplankton somatic P - mg P mg C^-1#
EPAmin=0.0007 #minimum zooplankton somatic EPA - mg EPA mg C-1#
EPAopt=0.0082 #Optimum zooplankton somatic EPA - mg EPA mg C-1#
DHAmin=0.0001 #minimum zooplankton somatic DHA - mg DHA mg C-1#
DHAopt=0.0014 #Optimum zooplankton somatic DHA - mg DHA mg C^-1#
X=0.25 #Excretion rate - day^-1#
hEPA=0.8 #proxy reproduction paramter#
hDHA=0.8 #proxy reproduction parameter#
r=0.9 # growth rate#
p=0.5 #elongation efficiency#
thresh=0.05 #threshold for post maintenance concentration of EPA and DHA#
Jpufa=0.0118 #flux of C18 pufa to EPA
FQphyt=0.7#
PHYT=seq(0,1,by=0.05)#
#
times=seq(1,50,by=0.1)#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
PHYTgrowth<-c()#
for(i in 1:length(PHYT)){#
	parms<-c(FQphyt=FQphyt,PHYT=PHYT[i],FQdet=FQdet,DETc=DETc,aC1=aC1,aC2=aC2,lambda=lambda,wPhyt=wPhyt,wDet=wDet,mu=mu,PCphyt=PCphyt,fEPA=fEPA,fDHA=fDHA,sPC=sPC,sEPA=sEPA,sDHA=sDHA,tP=tP,tEPA=tEPA,tDHA=tDHA,tM=tM,m=m,v=v,e=e,Pmin=Pmin,Popt=Popt,EPAmin=EPAmin,EPAopt=EPAopt,DHAmin=DHAmin,DHAopt=DHAopt,X=X,hEPA=hEPA,hDHA=hDHA,r=r)#
	x=ode(y=n,times=times,func=timestep,parms=parms)#
	glimP=(x[49,2]-Pmin)/(Popt-Pmin)#
	glimEPA=(x[49,3]-EPAmin)/(EPAopt-EPAmin)#
	glimDHA=(x[49,4]-DHAmin)/(DHAopt-DHAmin)#
	PHYTgrowth[i]=r*min(glimP,glimEPA,glimDHA)#
}
require(deSolve)#
#
timestep<-function(t,y,params){#
with(as.list(params),{	#
	Pint<-y[1]#
	EPAint<-y[2]#
	DHAint<-y[3]#
#starts with food quality (FQtot) as a function of the concentration of phytoplankton (PHYT) and detritus (DETc) and their food quality indices#
#
FQtot<-FQphyt^2*sqrt(PHYT)+FQdet^2*sqrt(DETc)#
#
#calculates carbon assimilation efficiency (aC) using food quality and growth efficiency (aC1) and half saturation constant (aC2)#
#
aC<-(aC1*FQtot)/(aC2+FQtot)#
#
#calculates carbon assimilation rate using assimilation efficiency, and preference for phytoplankton (wPhyt) and detritus (wDet), max grazing rate (lambda), and half sat constant (mu)#
#
aSC<-(lambda*aC*(wPhyt*PHYT^2+wDet*DETc^2))/(mu^2+wPhyt*PHYT^2+wDet*DETc^2)#
#
#calculate pools of P, EPA, and DHA from grazed food resource concentrations in phytoplankton (PCphyt,fEPA, fDHA) and detritus (sPC,sEPA, and sDHA)#
#
GRAZp<-(wPhyt*PHYT^2*PCphyt+wDet*DETc^2*sPC)/(wPhyt*PHYT^2+wDet*DETc^2)#
#
GRAZepa<-(wPhyt*PHYT^2*fEPA+wDet*DETc^2*sEPA)/(wPhyt*PHYT^2+wDet*DETc^2)#
#
GRAZdha<-(wPhyt*PHYT^2*fDHA+wDet*DETc^2*sDHA)/(wPhyt*PHYT^2+wDet*DETc^2)#
#
#Post-maintenance reosurce pool (Ppm, EPApm, and DHApm) of resources using internal quotas (Pint, EPAint, DHAint), biomass turnover rate (tP,tEPA,tDHA), moulting turnover rate (tM), moulting fraction (m), EPA-DHA conversion (e) and conversion efficiency of EPA-DHA (v)#
#
Ppm<-aSC*GRAZp-Pint*(tP*(1-m)*m*tM)#
#
#IF EPApm IS GREATER THAN THRESHOLD - DO IT THIS WAY - NEED TO MAKE A DIFFERENT FUNCTION FOR WHEN EPApm IS LESS THAN OR EQUAL TO THE THRESHOLD#
#
EPApm<-(1-e)*(aSC*GRAZepa-EPAint*(tEPA*(1-m)+m*tM))#
#
DHApm<-aSC*GRAZdha-DHAint*(tDHA*(1-m)+m*tM)+v*e*(aSC*GRAZepa-EPAint*(tEPA*(1-m)+m*tM))#
#
#make if statement for if post maintenance EPA and DHA concentrations are below a threshold, C18 PUFA elongation becomes important#
if(EPApm < thresh){#
	EPApm<-aSC*GRAZepa-EPAint*(tEPA*(1-m)+m*tM)+(1-e)*Jpufa*p#
	DHApm<-aSC*GRAZdha-DHAint*(tDHA*(1-m)+m*tM)+e*Jpufa*p*v#
}#
#
#resource saturation quotient (glimP, glimEPA, glimDHA) using internal quota of reosurces, optimal somatic concentration of resources, and minimal concentration of resources (Droop model)#
#
glimP<-(Pint-Pmin)/(Popt-Pmin)#
#
glimEPA<-(EPAint-EPAmin)/(EPAopt-EPAmin)#
#
glimDHA<-(DHAint-DHAmin)/(DHAopt-DHAmin)#
#
#now growth rate as altered by the limitation by resource limitation - uses max growth rate (r)#
#
GROWTH<-r*glimP*glimEPA*glimDHA#
#differential equations - the change in the internal quota of P, EPA, and DHA - uses the release rate of P (X), and the loss to hormone production (h) for EFAs#
#
Pint<-Ppm-GROWTH*Pint-X*Pint#
#
EPAint<-EPApm-GROWTH*EPAint-hEPA*EPAint#
#
DHAint<-DHApm-GROWTH*DHAint-hDHA*DHAint#
#
return(list(c(Pint,EPAint,DHAint)))#
})#
}
FQphyt=0.7#
PHYT=seq(0,1,by=0.05)#
#
times=seq(1,50,by=0.1)#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
PHYTgrowth<-c()#
for(i in 1:length(PHYT)){#
	parms<-c(FQphyt=FQphyt,PHYT=PHYT[i],FQdet=FQdet,DETc=DETc,aC1=aC1,aC2=aC2,lambda=lambda,wPhyt=wPhyt,wDet=wDet,mu=mu,PCphyt=PCphyt,fEPA=fEPA,fDHA=fDHA,sPC=sPC,sEPA=sEPA,sDHA=sDHA,tP=tP,tEPA=tEPA,tDHA=tDHA,tM=tM,m=m,v=v,e=e,Pmin=Pmin,Popt=Popt,EPAmin=EPAmin,EPAopt=EPAopt,DHAmin=DHAmin,DHAopt=DHAopt,X=X,hEPA=hEPA,hDHA=hDHA,r=r)#
	x=ode(y=n,times=times,func=timestep,parms=parms)#
	glimP=(x[49,2]-Pmin)/(Popt-Pmin)#
	glimEPA=(x[49,3]-EPAmin)/(EPAopt-EPAmin)#
	glimDHA=(x[49,4]-DHAmin)/(DHAopt-DHAmin)#
	PHYTgrowth[i]=r*min(glimP,glimEPA,glimDHA)#
}
FQtot<-FQphyt^2*sqrt(PHYT)+FQdet^2*sqrt(DETc)
FQtot
aC<-(aC1*FQtot)/(aC2+FQtot)
cA
aC
aSC<-(lambda*aC*(wPhyt*PHYT^2+wDet*DETc^2))/(mu^2+wPhyt*PHYT^2+wDet*DETc^2)
aSC
GRAZp<-(wPhyt*PHYT^2*PCphyt+wDet*DETc^2*sPC)/(wPhyt*PHYT^2+wDet*DETc^2)#
#
GRAZepa<-(wPhyt*PHYT^2*fEPA+wDet*DETc^2*sEPA)/(wPhyt*PHYT^2+wDet*DETc^2)#
#
GRAZdha<-(wPhyt*PHYT^2*fDHA+wDet*DETc^2*sDHA)/(wPhyt*PHYT^2+wDet*DETc^2)
Ppm<-aSC*GRAZp-Pint*(tP*(1-m)*m*tM)
EPApm<-(1-e)*(aSC*GRAZepa-EPAint*(tEPA*(1-m)+m*tM))#
#
DHApm<-aSC*GRAZdha-DHAint*(tDHA*(1-m)+m*tM)+v*e*(aSC*GRAZepa-EPAint*(tEPA*(1-m)+m*tM))
y=n
y
Pint<-y[1]#
	EPAint<-y[2]#
	DHAint<-y[3]
Ppm<-aSC*GRAZp-Pint*(tP*(1-m)*m*tM)
EPApm<-(1-e)*(aSC*GRAZepa-EPAint*(tEPA*(1-m)+m*tM))#
#
DHApm<-aSC*GRAZdha-DHAint*(tDHA*(1-m)+m*tM)+v*e*(aSC*GRAZepa-EPAint*(tEPA*(1-m)+m*tM))
EPApm
(1-e)*(aSC*GRAZepa-EPAint*(tEPA*(1-m)+m*tM))
(1-e)
GRAZepa
wPhyt*PHYT^2
(wPhyt*PHYT^2*fEPA+wDet*DETc^2*sEPA)/(wPhyt*PHYT^2+wDet*DETc^2)
wPhyt*PHYT^2
PHYT^2
wPhyt
FQphyt=0.7#
PHYT=seq(0.05,2,by=0.05)#
#
times=seq(1,50,by=0.1)#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
PHYTgrowth<-c()#
for(i in 1:length(PHYT)){#
	parms<-c(FQphyt=FQphyt,PHYT=PHYT[i],FQdet=FQdet,DETc=DETc,aC1=aC1,aC2=aC2,lambda=lambda,wPhyt=wPhyt,wDet=wDet,mu=mu,PCphyt=PCphyt,fEPA=fEPA,fDHA=fDHA,sPC=sPC,sEPA=sEPA,sDHA=sDHA,tP=tP,tEPA=tEPA,tDHA=tDHA,tM=tM,m=m,v=v,e=e,Pmin=Pmin,Popt=Popt,EPAmin=EPAmin,EPAopt=EPAopt,DHAmin=DHAmin,DHAopt=DHAopt,X=X,hEPA=hEPA,hDHA=hDHA,r=r)#
	x=ode(y=n,times=times,func=timestep,parms=parms)#
	glimP=(x[49,2]-Pmin)/(Popt-Pmin)#
	glimEPA=(x[49,3]-EPAmin)/(EPAopt-EPAmin)#
	glimDHA=(x[49,4]-DHAmin)/(DHAopt-DHAmin)#
	PHYTgrowth[i]=r*min(glimP,glimEPA,glimDHA)#
}
plot(PHYT,PHYTgrowth)
c=aggregate(resourceQual$mgC_L,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)#
colnames(c)=c('lakeID','dateSample','depthClass','mgC_L')
resourceQual=cbind(x,mgC_L=c[,4],mgP_mgC=y[,4],mgEPA_mgC=z[,4],mgDHA_mgC=a[,4],C18PUFA_mgC=b[,4])
x=aggregate(resourceQual$mgC_L,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)#
colnames(x)=c('lakeID','dateSample','depthClass','mgC_L')#
y=aggregate(resourceQual$mgP_mgC,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)#
colnames(y)=c('lakeID','dateSample','depthClass','mgP_mgC')#
z=aggregate(resourceQual$mgEPA_mgC,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)#
colnames(z)=c('lakeID','dateSample','depthClass','mgEPA_mgC')#
a=aggregate(resourceQual$mgDHA_mgC,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)#
colnames(a)=c('lakeID','dateSample','depthClass','mgDHA_mgC')#
b=aggregate(resourceQual$C18PUFA_mgC,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)#
colnames(b)=c('lakeID','dateSample','depthClass','C18PUFA_mgC')#
c=aggregate(resourceQual$mgC_L,by=list(resourceQual$lakeID,resourceQual$dateSample,resourceQual$depthClass),mean,na.rm=T)#
colnames(c)=c('lakeID','dateSample','depthClass','mgC_L')#
#
resourceQual=cbind(x,mgC_L=c[,4],mgP_mgC=y[,4],mgEPA_mgC=z[,4],mgDHA_mgC=a[,4],C18PUFA_mgC=b[,4])
resourceQual
remove CR from chaob data#
chaobDens<-chaobDens[chaobDens$lakeID!='CR',]#
#
#match chaoborus data with resource qual data from the closest date similar to how resource quality data was matched#
modelParms<-c()#
for(i in 1:nrow(chaobDens)){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms
i=1
samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]
RQi
modelParms<-c()#
for(i in 1:nrow(chaobDens)){#
	samplei=chaobDens[i,]#
	RQi=resourceQual[resourceQual$lakeID==samplei$lakeID & resourceQual$depthClass==samplei$depthClass,]#
	mgC_L=RQi$mgC_L[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	epa=RQi$mgEPA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	dha=RQi$mgDHA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	PC=RQi$mgP_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	C18=RQi$C18PUFA_mgC[which(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y')) == min(abs(as.Date(RQi$dateSample,'%m/%d/%y')-as.Date(samplei$dateSample,'%m/%d/%y'))))]#
	samplei$mgC_L=mgC_L#
	samplei$EPA_mgC=epa#
	samplei$DHA_mgC=dha#
	samplei$PC=PC#
	samplei$C18_mgC=C18#
	modelParms=rbind(modelParms,samplei)#
}
modelParms
parms<-c(FQphyt=0.5,PHYT=modelParms$mgC_L[i],FQdet=0.1,DETc=0.1,aC1=0.9,aC2=0.03,lambda=0.6,wPhyt=1,wDet=0,mu=0.035,PCphyt=modelParms$PC[1],fEPA=modelParms$EPA_mgC[1],fDHA=modelParms$DHA_mgC[1],sPC=0.00001,sEPA=0.00001,sDHA=0.00001,tP=0.1,tEPA=0.1,tDHA=0.1,tM=0.05,m=0.05,v=0.5,e=0.05,Pmin=0.009,Popt=0.05,EPAmin=0.0007,EPAopt=0.0082,DHAmin=0.0001,DHAopt=0.0014,X=0.25,hEPA=0.8,hDHA=0.8,r=0.9,p=0.5,thresh=0.05,Jpufa=0.0118)
times=seq(1,500,by=0.1)#
#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
test<-ode(y=n,times=times,func=timestep,parms=parms)
Pmin=0.009#
Popt=0.05#
EPAmin=0.0007#
EPAopt=0.0082#
DHAmin=0.0001#
DHAopt=0.0014#
r=0.9#
#
#calculate growth rate#
glimP<-(test[4991,2]-Pmin)/(Popt-Pmin)#
glimEPA<-(test[4991,3]-EPAmin)/(EPAopt-EPAmin)#
glimDHA<-(test[4991,4]-DHAmin)/(DHAopt-DHAmin)
glimP
glimEPA
glimDHA
growth<-r*min(c(glimP,glimEPA,glimDHA))
growth
.9*0.08
parms<-c(FQphyt=0.5,PHYT=modelParms$mgC_L[2],FQdet=0.1,DETc=0.1,aC1=0.9,aC2=0.03,lambda=0.6,wPhyt=1,wDet=0,mu=0.035,PCphyt=modelParms$PC[2],fEPA=modelParms$EPA_mgC[2],fDHA=modelParms$DHA_mgC[2],sPC=0.00001,sEPA=0.00001,sDHA=0.00001,tP=0.1,tEPA=0.1,tDHA=0.1,tM=0.05,m=0.05,v=0.5,e=0.05,Pmin=0.009,Popt=0.05,EPAmin=0.0007,EPAopt=0.0082,DHAmin=0.0001,DHAopt=0.0014,X=0.25,hEPA=0.8,hDHA=0.8,r=0.9,p=0.5,thresh=0.05,Jpufa=0.0118)#
#
times=seq(1,500,by=0.1)#
#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
test<-ode(y=n,times=times,func=timestep,parms=parms)#
#
Pmin=0.009#
Popt=0.05#
EPAmin=0.0007#
EPAopt=0.0082#
DHAmin=0.0001#
DHAopt=0.0014#
r=0.9#
#
#calculate growth rate#
glimP<-(test[4991,2]-Pmin)/(Popt-Pmin)#
glimEPA<-(test[4991,3]-EPAmin)/(EPAopt-EPAmin)#
glimDHA<-(test[4991,4]-DHAmin)/(DHAopt-DHAmin)#
#
growth<-r*min(c(glimP,glimEPA,glimDHA))
growth
moelParms
modelParms
modelParms[!is.na(modelParms),]
i=1
if(modelParms$mgC_L[i]!=NA & modelParms$PC[i]!=NA & modelParms$EPA_mgC[i]!=NA & modelParms$DHA_mgC[i]!=NA){	#
parms<-c(FQphyt=0.5,PHYT=modelParms$mgC_L[2],FQdet=0.1,DETc=0.1,aC1=0.9,aC2=0.03,lambda=0.6,wPhyt=1,wDet=0,mu=0.035,PCphyt=modelParms$PC[2],fEPA=modelParms$EPA_mgC[2],fDHA=modelParms$DHA_mgC[2],sPC=0.00001,sEPA=0.00001,sDHA=0.00001,tP=0.1,tEPA=0.1,tDHA=0.1,tM=0.05,m=0.05,v=0.5,e=0.05,Pmin=0.009,Popt=0.05,EPAmin=0.0007,EPAopt=0.0082,DHAmin=0.0001,DHAopt=0.0014,X=0.25,hEPA=0.8,hDHA=0.8,r=0.9,p=0.5,thresh=0.05,Jpufa=0.0118)#
#
times=seq(1,500,by=0.1)#
#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
test<-ode(y=n,times=times,func=timestep,parms=parms)#
#
Pmin=0.009#
Popt=0.05#
EPAmin=0.0007#
EPAopt=0.0082#
DHAmin=0.0001#
DHAopt=0.0014#
r=0.9#
#
#calculate growth rate#
glimP<-(test[4991,2]-Pmin)/(Popt-Pmin)#
glimEPA<-(test[4991,3]-EPAmin)/(EPAopt-EPAmin)#
glimDHA<-(test[4991,4]-DHAmin)/(DHAopt-DHAmin)#
#
r=0.9#
growth[i]<-r*min(c(glimP,glimEPA,glimDHA))#
}#
else{#
	growth[i]=NA#
	}
i
modelParms$mgC_L[i]!=NA & modelParms$PC[i]!=NA & modelParms$EPA_mgC[i]!=NA & modelParms$DHA_mgC[i]!=NA
odelParms$mgC_L[i]!=NA
modelParms$mgC_L[i]!=NA
if(modelParms$mgC_L[i]!=NA & modelParms$PC[i]!=NA & modelParms$EPA_mgC[i]!=NA & modelParms$DHA_mgC[i]!=NA)
!is.na(modelParms$mgC_L[i])
!is.na(modelParms$mgC_L[i])
if(!is.na(modelParms$mgC_L[i]) & !is.na(modelParms$PC[i]) & !is.na(modelParms$EPA_mgC[i]) & !is.na(modelParms$DHA_mgC[i])){	#
parms<-c(FQphyt=0.5,PHYT=modelParms$mgC_L[2],FQdet=0.1,DETc=0.1,aC1=0.9,aC2=0.03,lambda=0.6,wPhyt=1,wDet=0,mu=0.035,PCphyt=modelParms$PC[2],fEPA=modelParms$EPA_mgC[2],fDHA=modelParms$DHA_mgC[2],sPC=0.00001,sEPA=0.00001,sDHA=0.00001,tP=0.1,tEPA=0.1,tDHA=0.1,tM=0.05,m=0.05,v=0.5,e=0.05,Pmin=0.009,Popt=0.05,EPAmin=0.0007,EPAopt=0.0082,DHAmin=0.0001,DHAopt=0.0014,X=0.25,hEPA=0.8,hDHA=0.8,r=0.9,p=0.5,thresh=0.05,Jpufa=0.0118)#
#
times=seq(1,500,by=0.1)#
#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
test<-ode(y=n,times=times,func=timestep,parms=parms)#
#
Pmin=0.009#
Popt=0.05#
EPAmin=0.0007#
EPAopt=0.0082#
DHAmin=0.0001#
DHAopt=0.0014#
r=0.9#
#
#calculate growth rate#
glimP<-(test[4991,2]-Pmin)/(Popt-Pmin)#
glimEPA<-(test[4991,3]-EPAmin)/(EPAopt-EPAmin)#
glimDHA<-(test[4991,4]-DHAmin)/(DHAopt-DHAmin)#
#
r=0.9#
growth[i]<-r*min(c(glimP,glimEPA,glimDHA))#
}#
else{#
	growth[i]=NA#
	}
growth
if(is.na(modelParms$mgC_L[i]) | is.na(modelParms$PC[i]) | is.na(modelParms$EPA_mgC[i]) | is.na(modelParms$DHA_mgC[i])){
}
if(is.na(modelParms$mgC_L[i]) | is.na(modelParms$PC[i]) | is.na(modelParms$EPA_mgC[i]) | is.na(modelParms$DHA_mgC[i]))
)
is.na(modelParms$mgC_L[i]) | is.na(modelParms$PC[i]) | is.na(modelParms$EPA_mgC[i]) | is.na(modelParms$DHA_mgC[i]
)
i
if(!is.na(modelParms$mgC_L[i]) & !is.na(modelParms$PC[i]) & !is.na(modelParms$EPA_mgC[i]) & !is.na(modelParms$DHA_mgC[i])){	#
parms<-c(FQphyt=0.5,PHYT=modelParms$mgC_L[2],FQdet=0.1,DETc=0.1,aC1=0.9,aC2=0.03,lambda=0.6,wPhyt=1,wDet=0,mu=0.035,PCphyt=modelParms$PC[2],fEPA=modelParms$EPA_mgC[2],fDHA=modelParms$DHA_mgC[2],sPC=0.00001,sEPA=0.00001,sDHA=0.00001,tP=0.1,tEPA=0.1,tDHA=0.1,tM=0.05,m=0.05,v=0.5,e=0.05,Pmin=0.009,Popt=0.05,EPAmin=0.0007,EPAopt=0.0082,DHAmin=0.0001,DHAopt=0.0014,X=0.25,hEPA=0.8,hDHA=0.8,r=0.9,p=0.5,thresh=0.05,Jpufa=0.0118)#
#
times=seq(1,500,by=0.1)#
#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
test<-ode(y=n,times=times,func=timestep,parms=parms)#
#
Pmin=0.009#
Popt=0.05#
EPAmin=0.0007#
EPAopt=0.0082#
DHAmin=0.0001#
DHAopt=0.0014#
r=0.9#
#
#calculate growth rate#
glimP<-(test[4991,2]-Pmin)/(Popt-Pmin)#
glimEPA<-(test[4991,3]-EPAmin)/(EPAopt-EPAmin)#
glimDHA<-(test[4991,4]-DHAmin)/(DHAopt-DHAmin)#
#
r=0.9#
growth[i]<-r*min(c(glimP,glimEPA,glimDHA))#
}#
if(is.na(modelParms$mgC_L[i]) | is.na(modelParms$PC[i]) | is.na(modelParms$EPA_mgC[i]) | is.na(modelParms$DHA_mgC[i])){#
	growth[i]=NA#
	}
growth
if(!is.na(modelParms$mgC_L[i]) & !is.na(modelParms$PC[i]) & !is.na(modelParms$EPA_mgC[i]) & !is.na(modelParms$DHA_mgC[i])){	#
parms<-c(FQphyt=0.5,PHYT=modelParms$mgC_L[2],FQdet=0.1,DETc=0.1,aC1=0.9,aC2=0.03,lambda=0.6,wPhyt=1,wDet=0,mu=0.035,PCphyt=modelParms$PC[2],fEPA=modelParms$EPA_mgC[2],fDHA=modelParms$DHA_mgC[2],sPC=0.00001,sEPA=0.00001,sDHA=0.00001,tP=0.1,tEPA=0.1,tDHA=0.1,tM=0.05,m=0.05,v=0.5,e=0.05,Pmin=0.009,Popt=0.05,EPAmin=0.0007,EPAopt=0.0082,DHAmin=0.0001,DHAopt=0.0014,X=0.25,hEPA=0.8,hDHA=0.8,r=0.9,p=0.5,thresh=0.05,Jpufa=0.0118)#
#
times=seq(1,500,by=1)#
#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
test<-ode(y=n,times=times,func=timestep,parms=parms)#
#
Pmin=0.009#
Popt=0.05#
EPAmin=0.0007#
EPAopt=0.0082#
DHAmin=0.0001#
DHAopt=0.0014#
r=0.9#
#
#calculate growth rate#
glimP<-(test[4991,2]-Pmin)/(Popt-Pmin)#
glimEPA<-(test[4991,3]-EPAmin)/(EPAopt-EPAmin)#
glimDHA<-(test[4991,4]-DHAmin)/(DHAopt-DHAmin)#
#
r=0.9#
growth[i]<-r*min(c(glimP,glimEPA,glimDHA))#
}#
if(is.na(modelParms$mgC_L[i]) | is.na(modelParms$PC[i]) | is.na(modelParms$EPA_mgC[i]) | is.na(modelParms$DHA_mgC[i])){#
	growth[i]=NA#
	}
if(!is.na(modelParms$mgC_L[i]) & !is.na(modelParms$PC[i]) & !is.na(modelParms$EPA_mgC[i]) & !is.na(modelParms$DHA_mgC[i])){	#
parms<-c(FQphyt=0.5,PHYT=modelParms$mgC_L[2],FQdet=0.1,DETc=0.1,aC1=0.9,aC2=0.03,lambda=0.6,wPhyt=1,wDet=0,mu=0.035,PCphyt=modelParms$PC[2],fEPA=modelParms$EPA_mgC[2],fDHA=modelParms$DHA_mgC[2],sPC=0.00001,sEPA=0.00001,sDHA=0.00001,tP=0.1,tEPA=0.1,tDHA=0.1,tM=0.05,m=0.05,v=0.5,e=0.05,Pmin=0.009,Popt=0.05,EPAmin=0.0007,EPAopt=0.0082,DHAmin=0.0001,DHAopt=0.0014,X=0.25,hEPA=0.8,hDHA=0.8,r=0.9,p=0.5,thresh=0.05,Jpufa=0.0118)#
#
times=seq(1,500,by=1)#
#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
test<-ode(y=n,times=times,func=timestep,parms=parms)#
#
Pmin=0.009#
Popt=0.05#
EPAmin=0.0007#
EPAopt=0.0082#
DHAmin=0.0001#
DHAopt=0.0014#
r=0.9#
#
#calculate growth rate#
glimP<-(test[41,2]-Pmin)/(Popt-Pmin)#
glimEPA<-(test[41,3]-EPAmin)/(EPAopt-EPAmin)#
glimDHA<-(test[41,4]-DHAmin)/(DHAopt-DHAmin)#
#
r=0.9#
growth[i]<-r*min(c(glimP,glimEPA,glimDHA))#
}#
if(is.na(modelParms$mgC_L[i]) | is.na(modelParms$PC[i]) | is.na(modelParms$EPA_mgC[i]) | is.na(modelParms$DHA_mgC[i])){#
	growth[i]=NA#
	}
growth<-c()#
for(i in 1:nrow(modelParms)){#
if(!is.na(modelParms$mgC_L[i]) & !is.na(modelParms$PC[i]) & !is.na(modelParms$EPA_mgC[i]) & !is.na(modelParms$DHA_mgC[i])){	#
parms<-c(FQphyt=0.5,PHYT=modelParms$mgC_L[2],FQdet=0.1,DETc=0.1,aC1=0.9,aC2=0.03,lambda=0.6,wPhyt=1,wDet=0,mu=0.035,PCphyt=modelParms$PC[2],fEPA=modelParms$EPA_mgC[2],fDHA=modelParms$DHA_mgC[2],sPC=0.00001,sEPA=0.00001,sDHA=0.00001,tP=0.1,tEPA=0.1,tDHA=0.1,tM=0.05,m=0.05,v=0.5,e=0.05,Pmin=0.009,Popt=0.05,EPAmin=0.0007,EPAopt=0.0082,DHAmin=0.0001,DHAopt=0.0014,X=0.25,hEPA=0.8,hDHA=0.8,r=0.9,p=0.5,thresh=0.05,Jpufa=0.0118)#
#
times=seq(1,500,by=1)#
#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
test<-ode(y=n,times=times,func=timestep,parms=parms)#
#
Pmin=0.009#
Popt=0.05#
EPAmin=0.0007#
EPAopt=0.0082#
DHAmin=0.0001#
DHAopt=0.0014#
r=0.9#
#
#calculate growth rate#
glimP<-(test[41,2]-Pmin)/(Popt-Pmin)#
glimEPA<-(test[41,3]-EPAmin)/(EPAopt-EPAmin)#
glimDHA<-(test[41,4]-DHAmin)/(DHAopt-DHAmin)#
#
r=0.9#
growth[i]<-r*min(c(glimP,glimEPA,glimDHA))#
}#
if(is.na(modelParms$mgC_L[i]) | is.na(modelParms$PC[i]) | is.na(modelParms$EPA_mgC[i]) | is.na(modelParms$DHA_mgC[i])){#
	growth[i]=NA#
	}#
}
growth
i=2
parms<-c(FQphyt=0.5,PHYT=modelParms$mgC_L[2],FQdet=0.1,DETc=0.1,aC1=0.9,aC2=0.03,lambda=0.6,wPhyt=1,wDet=0,mu=0.035,PCphyt=modelParms$PC[2],fEPA=modelParms$EPA_mgC[2],fDHA=modelParms$DHA_mgC[2],sPC=0.00001,sEPA=0.00001,sDHA=0.00001,tP=0.1,tEPA=0.1,tDHA=0.1,tM=0.05,m=0.05,v=0.5,e=0.05,Pmin=0.009,Popt=0.05,EPAmin=0.0007,EPAopt=0.0082,DHAmin=0.0001,DHAopt=0.0014,X=0.25,hEPA=0.8,hDHA=0.8,r=0.9,p=0.5,thresh=0.05,Jpufa=0.0118)
growth<-c()#
for(i in 1:nrow(modelParms)){#
if(!is.na(modelParms$mgC_L[i]) & !is.na(modelParms$PC[i]) & !is.na(modelParms$EPA_mgC[i]) & !is.na(modelParms$DHA_mgC[i])){	#
parms<-c(FQphyt=0.5,PHYT=modelParms$mgC_L[i],FQdet=0.1,DETc=0.1,aC1=0.9,aC2=0.03,lambda=0.6,wPhyt=1,wDet=0,mu=0.035,PCphyt=modelParms$PC[i],fEPA=modelParms$EPA_mgC[i],fDHA=modelParms$DHA_mgC[i],sPC=0.00001,sEPA=0.00001,sDHA=0.00001,tP=0.1,tEPA=0.1,tDHA=0.1,tM=0.05,m=0.05,v=0.5,e=0.05,Pmin=0.009,Popt=0.05,EPAmin=0.0007,EPAopt=0.0082,DHAmin=0.0001,DHAopt=0.0014,X=0.25,hEPA=0.8,hDHA=0.8,r=0.9,p=0.5,thresh=0.05,Jpufa=0.0118)#
#
times=seq(1,500,by=1)#
#
n=c(Pint=0.5,EPAint=0.5,DHAint=0.5)#
#
test<-ode(y=n,times=times,func=timestep,parms=parms)#
#
Pmin=0.009#
Popt=0.05#
EPAmin=0.0007#
EPAopt=0.0082#
DHAmin=0.0001#
DHAopt=0.0014#
r=0.9#
#
#calculate growth rate#
glimP<-(test[41,2]-Pmin)/(Popt-Pmin)#
glimEPA<-(test[41,3]-EPAmin)/(EPAopt-EPAmin)#
glimDHA<-(test[41,4]-DHAmin)/(DHAopt-DHAmin)#
#
r=0.9#
growth[i]<-r*min(c(glimP,glimEPA,glimDHA))#
}#
if(is.na(modelParms$mgC_L[i]) | is.na(modelParms$PC[i]) | is.na(modelParms$EPA_mgC[i]) | is.na(modelParms$DHA_mgC[i])){#
	growth[i]=NA#
	}#
}
growth
plot(modelParms$PC,growth)
plot(modelParms$EPA_mgC,growth)
plot(modelParms$DHA_mgC,growth)
summary(lm(growth~modelParms$PC))
summary(lm(growth~modelParms$PC+modelParms$EPA_mgC))
summary(lm(growth~modelParms$PC+modelParms$EPA_mgC+modelParms$mgC_L))
plot(modelParms$mgC_L,growth)
modelParms
growth
test=data.frame(modelParms[,c(2,3,6)],growth)
test
boxplot(test$growth~test$depthClass)
boxplot(test$growth~test$lakeID)
lakeParms
summarize water chemistry data for analysis with DVM data - put into table that can be loaded into data anlysis scripts - get seasonal averages for all lakes for pml and meta#
#PTK Feb 21 2014#
#
#specify which lakes to include#
lakes<-c('BA','BR','CB','DW','HB','RB','RE','RS','TU','WL')#
#
#DOC#
dbListFields(con,'DOC')#
#
DOC<-dbGetQuery(con,'SELECT DOC.projectID,DOC.lakeID,DOC.dateSample,DOC.depthClass,DOC.depthTop,DOC.depthBottom,DOC.DOC,DOC.comments,DOC.flag FROM DOC')#
#
#add year to DOC data#
DOC<-addYear(DOC)#
#use only 2013 data#
doc2013<-DOC[DOC$year==2013,]#
#select only lakes above#
doc2013<-doc2013[doc2013$lakeID %in% lakes,]#
PMLdoc<-tapply(doc2013$DOC[doc2013$depthClass=='PML'],doc2013$lakeID[doc2013$depthClass=='PML'],mean,na.rm=T)#
Metadoc<-tapply(doc2013$DOC[doc2013$depthClass=='Meta'],doc2013$lakeID[doc2013$depthClass=='Meta'],mean,na.rm=T)#
#color data#
dbListFields(con,'COLOR')#
#
color<-dbGetQuery(con,'SELECT color.projectID,color.lakeID,color.dateSample,color.depthClass,color.depthTop,color.depthBottom,color.g440,color.comments,color.flag FROM COLOR AS color')#
#
color<-addYear(color)#
#use only 2013 data#
color2013<-color[color$year==2013,]#
#select only our lakes#
color2013<-color2013[color2013$lakeID %in% lakes,]#
PMLColor<-tapply(as.numeric(color2013$g440[color2013$depthClass=='PML']),color2013$lakeID[color2013$depthClass=='PML'],mean,na.rm=T)#
MetaColor<-tapply(as.numeric(color2013$g440[color2013$depthClass=='Meta']),color2013$lakeID[color2013$depthClass=='Meta'],mean,na.rm=T)#
#
#chlorophyll data#
dbListFields(con,'CHLOROPHYLL')#
#
chl<-dbGetQuery(con,'SELECT chl.projectID,chl.lakeID,chl.dateSample,chl.depthClass,chl.depthTop,chl.depthBottom,chl.chl,chl.comments,chl.flag FROM CHLOROPHYLL AS chl')#
#
chl<-addYear(chl)#
#
chl2013<-chl[chl$year==2013,]#
chl2013<-chl2013[chl2013$lakeID %in% lakes,]#
PMLchl<-tapply(chl2013$chl[chl2013$depthClass=='PML'],chl2013$lakeID[chl2013$depthClass=='PML'],mean,na.rm=T)#
Metachl<-tapply(chl2013$chl[chl2013$depthClass=='Meta'],chl2013$lakeID[chl2013$depthClass=='Meta'],mean,na.rm=T)#
#Limno profle data#
dbListFields(con,'LIMNO_PROFILES')#
#
profs<-dbGetQuery(con,'SELECT lp.projectID,lp.lakeID,lp.dateSample,lp.depthClass,lp.depthTop,lp.depthBottom,lp.temp,lp.DOmgL,lp.PAR,lp.comments FROM LIMNO_PROFILES AS lp')#
#
profs<-addYear(profs)#
#
profs2013<-profs[profs$year==2013,]#
surfaceProfs<-profs2013[profs2013$depthTop==0.5,]#
profs2013<-profs2013[profs2013$lakeID %in% lakes,]#
surfaceProfs<-surfaceProfs[surfaceProfs$lakeID %in% lakes,]
surfaceProfs
metaDepth<-tapply(chl2013$depthTop[chl2013$depthClass=='Meta'],chl2013$lakeID[chl2013$depthClass=='Meta'],mean,na.rm=T)#
metaDepth=round(metaDepth)
metaDepth
metaProfs<-c()#
for(i in 1:length(lakes)){#
	x<-profs2013[profs2013$lakeID==lakes[i] & profs2013$depthTop==metaDepth[i],]#
	metaProfs<-rbind(metaProfs,x)#
}
metaProfs
setwd('~/patk9105/Zoop-Fitness-Model')
setwd('~/Users/patk9105/Zoop-Fitness-Model')
setwd('~/')
list.files()
setwd('~/Zoop-Fitness-Model')
list.files()
